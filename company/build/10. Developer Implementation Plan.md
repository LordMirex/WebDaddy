Developer Handoff Guide / Implementation Plan
Setup Instructions

Local environment: Install PHP 7.4 or higher with Apache and MySQL (e.g. using XAMPP, MAMP, or Linux LAMP). Ensure PHP’s mysqli or PDO extensions are enabled. Use phpMyAdmin or MySQL CLI to manage the database.

cPanel Deployment: For production, use cPanel’s MySQL and PHP settings. Set the PHP version to ≥7.4 in MultiPHP Manager and create the MySQL database via MySQL® Databases.

Repository: Initialize a GitHub repository with a clear structure:

public/ – public site files (index.php, template listing, etc.)

admin/ – admin panel files (login, templates CRUD, domain inventory, orders, affiliates)

affiliate/ – affiliate dashboard pages (login, earnings, withdrawals)

includes/ – shared PHP files (e.g. config.php, functions.php)

vendor/ – for Composer packages (like PHPMailer) if used.
Add a .gitignore to exclude sensitive files (includes/config.php, vendor/, etc.) and IDE/project files.

Configuration: Create includes/config.php to hold environment-specific settings. Define constants or variables such as:

define('DB_HOST',   'localhost');
define('DB_NAME',   'template_store');
define('DB_USER',   'dbuser');
define('DB_PASS',   'dbpass');
define('WHATSAPP_NUMBER', '+1234567890');
define('SMTP_USER', 'you@example.com');
define('SMTP_PASS', 'your_smtp_password');
// etc.


Use this file to configure database connection, WhatsApp number (for wa.me links), SMTP/PHPMailer credentials, and other global settings (affiliate cookie duration, etc.).

Phase Breakdown

Project work is split into phases (estimated durations):

Phase 0: Environment & Repo Setup (0.5 days)

Tasks: Install PHP 7.4+, Apache, MySQL on developer machines (or use XAMPP/MAMP). Create the GitHub repo and push an initial commit with folder structure. Add .gitignore entries for includes/config.php and vendor/. Ensure cPanel account is ready.

Dependencies: None (base environment).

Phase 1: Database Schema & Base Models (1 day)

Tasks: Design and implement the MySQL schema (tables for templates, domains, users/affiliates, orders, affiliate_clicks, withdrawals, activity_logs, etc.). Create a SQL DDL script (ready for phpMyAdmin import). In includes/functions.php, scaffold base functions or classes for DB access (using mysqli or PDO with prepared statements). For example, functions to connect to the database and perform basic CRUD.

Dependencies: Phase 0 (environment ready, repo initialized).

Phase 2: Public Site (2 days)

Tasks:

Template listing: Build public/index.php to query and display all templates (name, thumbnail, price). Use Bootstrap grid for layout.

Template detail/demo: Create a detail page or modal (e.g. template.php?id=...) showing template info and a “View Demo” iframe (in a fullscreen Bootstrap modal). If a demo iframe exists in the database, display it (per spec’s iframe demo modal).

Order form: Build a short form on the template page. The form should: collect minimal info (name, email, chosen domain if available, etc.), automatically include any affiliate code (from $_SESSION/cookie if present), then on submit save a pending_order record (see below) and redirect the user to a pre-filled WhatsApp chat link (wa.me/<WHATSAPP_NUMBER>?text=<message>).

Affiliate code persistence: On page load, check for ?aff=CODE in URL and store it in $_SESSION and set a cookie (e.g. 30-day expiry). Preserve this code through navigation so that when the form is submitted, the order record includes the affiliate code.

Redirect to WhatsApp: After inserting the pending order, use header('Location: https://wa.me/'.WHATSAPP_NUMBER.'?text='.urlencode($message)) to send the user to WhatsApp.

Dependencies: Phases 0–1 (database and initial code base in place).

Phase 3: Admin Panel (3 days)

Tasks:

Admin login: Create admin/login.php with authentication. Use password_hash()/password_verify() for admin passwords
tutorialrepublic.com
. After login, use session_regenerate_id(true) to prevent fixation
cheatsheetseries.owasp.org
 and set session flags (HttpOnly, Secure cookies).

Templates CRUD: Pages to add/edit/delete templates (fields: name, slug, price, description, demo URL, video links JSON).

Domain inventory: Page to add domains and optionally assign them to templates. Allow marking domains as available or in_use.

Orders/Customers: List all pending orders. For each, admin can mark as Paid, assign a domain (if not pre-selected), and enter customer credentials/notes. On marking paid: update order status, and optionally trigger an email with details (see email below).

Affiliate management: Interface to create affiliate accounts (name, email, code, commission rate), view affiliate click stats and earnings, and approve withdrawal requests.

Dependencies: Phases 0–2 (database and public flows ready, user table with admin accounts).

Phase 4: Affiliate Panel (1.5 days)

Tasks:

Affiliate login: Simple login page (likely by affiliate code or email/password). On login, regenerate session ID and set secure cookies.

Dashboard: Show affiliate metrics: referral link (?aff=CODE), total referred sales, pending commissions, paid commissions.

Withdrawals: Form to request a payout: select or input bank name, account number, etc. On submit, create a withdrawal_requests record.

Admin interface: (As needed) a way for admins to approve/reject requests and record payouts.

Dependencies: Phases 0–3 (user, order, commission logic in DB).

Phase 5: Reports, Email & QA (1 day)

Tasks:

Reports/Exports: Build CSV export pages for sales, domain inventory, and affiliate earnings. Use simple PHP scripts to query the database and output CSV headers for download.

Transactional Emails: Integrate PHPMailer (latest release via Composer or manual include
mailtrap.io
) for sending order confirmations or other notifications. Wrap mail-sending code in try/catch and log errors if sending fails
mailtrap.io
.

Testing: Perform end-to-end manual QA: place orders (with/without affiliate codes), verify pending orders, mark paid, assign domains, and ensure emails are sent. Check that affiliate commissions are calculated (e.g. 30% of price) and withdrawals can be requested. Confirm UI is responsive (using Bootstrap) and the public listing loads quickly.

Dependencies: All features complete.

Function Signatures

The core backend functions (in includes/functions.php) should have clear interfaces. For example:

getTemplates(bool $activeOnly = true): array — returns a list of templates (optionally only those marked active).

getTemplateById(int $id): ?array — retrieves one template’s data or null if not found.

getAvailableDomains(int $template_id): array — lists unsold domains for a template.

createPendingOrder(array $payload): int — inserts a new pending_order row (with template ID, domain choice, customer info, affiliate code) and returns its ID.

markOrderPaid(int $order_id): bool — marks the pending order as paid and records payment info. (Optionally logs a transaction.)

assignDomainToCustomer(int $domain_id, int $order_id): bool — flags the domain as sold/in_use and links it to the given order.

Additional helpful interfaces might include:

getOrders(string $status = 'pending'): array — fetch orders by status.

calculateAffiliateCommission(int $order_id): float — computes commission for a given order.

createWithdrawalRequest(int $affiliate_id, float $amount): bool — logs a payout request.

logActivity(string $message): void — writes a record to an activity_logs table.

(The above signatures are illustrative; adjust parameters/return types as needed. The architecture spec also suggests similar functions.)

Best Practices

Prepared Statements: Always use prepared statements with mysqli or PDO for database queries to prevent SQL injection
php.net
. Bind parameters instead of interpolating user input into SQL.

Input Sanitization: Validate and sanitize all user input. Use PHP’s filter functions (e.g. filter_var()) to check email or integer fields, and escape output with htmlspecialchars() when inserting data into HTML
eitca.org
. This protects against XSS attacks. For example, display htmlspecialchars($userName) in HTML.

Sessions & Cookies: Regenerate session IDs on login/logout (session_regenerate_id(true)) to prevent fixation
cheatsheetseries.owasp.org
. Use the HttpOnly flag on session cookies so JavaScript cannot access them
cheatsheetseries.owasp.org
. Store affiliate codes in the session and also set a cookie (e.g. 30 days) so referral codes persist across pages.

Redirect with WhatsApp: After processing the order form, redirect the user to the prefilled WhatsApp link (wa.me/<number>?text=...) using header('Location: ...'). As specified, on form submit save the pending_order row and then redirect to the WhatsApp chat with encoded message text.

Mail Handling: Use PHPMailer (or similar) for sending emails. Wrap mail sends in try/catch (PHPMailer throws exceptions) and log any errors
mailtrap.io
. Ensure isHTML(true) or false is set appropriately and that sender/recipient are validated.

.gitignore: Never commit sensitive files (e.g. config.php with credentials). Exclude vendor/ (if using Composer) and includes/config.php in .gitignore.

Tools and Libraries

Bootstrap 5: Include Bootstrap via its CDN links in your HTML. For example, add the <link> from jsDelivr into <head> (see Bootstrap docs)
getbootstrap.com
. Use Bootstrap’s grid and components for a mobile-first UI.

PHPMailer: Install the latest PHPMailer (e.g. via Composer: composer require phpmailer/phpmailer) as recommended by the official docs
mailtrap.io
. This library handles SMTP email with security (authentication, TLS) and prevents header-injection.

Version Control (Git): Use GitHub with a clear branching model. Maintain a main (production) branch and a dev branch for integration. Create feature branches named descriptively (e.g. feature/template-crud)
atlassian.com
. Make pull requests for merging changes; each PR should reference the related issue or task and include a summary of changes. Never push credentials or config to the repo.
