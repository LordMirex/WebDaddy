# .htaccess – Fixed & Working Version (November 2025)
Options -Indexes
DirectoryIndex index.php

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /

    # Optional: Force HTTPS (uncomment if you have SSL)
    # RewriteCond %{HTTPS} off
    # RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

    # 1. Remove trailing slashes (but not for real directories)
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^(.+)/$ /$1 [R=301,L]

    # 2. Block sensitive folders
    RewriteRule ^(includes|database|uploads/private)/ - [F,L]

    # 3. Serve real files and folders directly (CSS, JS, images, admin, api, assets, etc.)
    RewriteCond %{REQUEST_FILENAME} -f [OR]
    RewriteCond %{REQUEST_FILENAME} -d
    RewriteRule ^ - [L]

    # 4. Sitemap
    RewriteRule ^sitemap\.xml$ sitemap.php [L]
    RewriteRule ^sitemap/?$ sitemap.php [L]

    # 5. Template slug → template.php?slug=xxx
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule ^([a-zA-Z0-9_-]+)/?$ template.php?slug=$1 [QSA,L]

    # 6. Everything else → index.php
    RewriteRule ^ index.php [QSA,L]
</IfModule>

# Deny sensitive files
<FilesMatch "\.(env|sql|log|ini|bak|yml|yaml|sh|bat)$">
    Require all denied
</FilesMatch>
